(()=>{"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===_typeof(i)?i:String(i)),o)}var n,i}var e=function(){function EventEmitter(){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventEmitter),this._events=new Map}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(EventEmitter,[{key:"on",value:function on(e,t){var r;this._events.has(e)||this._events.set(e,new Set),null===(r=this._events.get(e))||void 0===r||r.add(t)}},{key:"off",value:function off(e,t){var r;this._events.has(e)&&(this._events.get(e).delete(t),0===(null===(r=this._events.get(e))||void 0===r?void 0:r.size)&&this._events.delete(e))}},{key:"emit",value:function emit(e,t){this._events.forEach((function(r,o){"*"===o&&r.forEach((function(r){return r({eventName:e,data:t})})),(o instanceof RegExp&&o.test(e)||o===e)&&r.forEach((function(e){return e(t)}))}))}},{key:"onAll",value:function onAll(e){this.on("*",e)}},{key:"offAll",value:function offAll(){this._events=new Map}},{key:"trigger",value:function trigger(e,t){var r=this;return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.emit(e,Object.assign(Object.assign({},o||{}),t||{}))}}}]),EventEmitter}();function apiUtil_typeof(e){return apiUtil_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},apiUtil_typeof(e)}function apiUtil_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function apiUtil_toPrimitive(e,t){if("object"!==apiUtil_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==apiUtil_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===apiUtil_typeof(i)?i:String(i)),o)}var n,i}var t=function(){function ApiUtil(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function apiUtil_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ApiUtil),this.baseUrl=e,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(t=r.headers)&&void 0!==t?t:{})}}return function apiUtil_createClass(e,t,r){return t&&apiUtil_defineProperties(e.prototype,t),r&&apiUtil_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ApiUtil,[{key:"handleResponse",value:function handleResponse(e){return e.ok?e.json():e.json().then((function(t){var r;return Promise.reject(null!==(r=t.error)&&void 0!==r?r:e.statusText)}))}},{key:"get",value:function get(e){return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(t)})).then(this.handleResponse)}}]),ApiUtil}(),r="".concat("https://larek-api.nomoreparties.co","/api/weblarek"),o="".concat("https://larek-api.nomoreparties.co","/content/weblarek"),n="onLoadedProducts",i="openCard",a="addProduct",l="openCart",c="deleteProduct",u="openOrder",s="openContacts",f="order",d="onOrdered",y="updateCart";function cartModel_typeof(e){return cartModel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cartModel_typeof(e)}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function cartModel_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cartModel_toPrimitive(e,t){if("object"!==cartModel_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cartModel_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cartModel_typeof(i)?i:String(i)),o)}var n,i}var p,m=function(){function CartModel(){!function cartModel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CartModel),this.products=new Map}return function cartModel_createClass(e,t,r){return t&&cartModel_defineProperties(e.prototype,t),r&&cartModel_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CartModel,[{key:"add",value:function add(e){this.products.set(e.id,e)}},{key:"delete",value:function _delete(e){this.products.delete(e.id)}},{key:"contains",value:function contains(e){return this.products.has(e.id)}},{key:"getProducts",value:function getProducts(){return _toConsumableArray(this.products.values())}},{key:"getPrice",value:function getPrice(){return this.getProducts().reduce((function(e,t){return e+t.price}),0)}},{key:"clear",value:function clear(){this.products.clear()}}]),CartModel}();function orderModel_typeof(e){return orderModel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},orderModel_typeof(e)}function orderModel_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function orderModel_toPrimitive(e,t){if("object"!==orderModel_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==orderModel_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===orderModel_typeof(i)?i:String(i)),o)}var n,i}function orderModel_createClass(e,t,r){return t&&orderModel_defineProperties(e.prototype,t),r&&orderModel_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}!function(e){e.Online="online",e.Offline="offline"}(p||(p={}));var h=orderModel_createClass((function OrderModel(){!function orderModel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OrderModel),this.address="",this.email="",this.phone=""}));function api_typeof(e){return api_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},api_typeof(e)}function api_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function api_toPrimitive(e,t){if("object"!==api_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==api_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===api_typeof(i)?i:String(i)),o)}var n,i}var b=function(){function Api(e){!function api_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Api),this.api=e}return function api_createClass(e,t,r){return t&&api_defineProperties(e.prototype,t),r&&api_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Api,[{key:"loadProducts",value:function loadProducts(){return this.api.get("/product")}},{key:"order",value:function order(e){return this.api.post("/order",e)}}]),Api}();function isSelector(e){return"string"==typeof e&&e.length>1}function ensureElement(e,t){if(isSelector(e)){var r=function ensureAllElements(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(isSelector(e))return Array.from(t.querySelectorAll(e));if(e instanceof NodeList)return Array.from(e);if(Array.isArray(e))return e;throw new Error("Unknown selector element")}(e,t);if(r.length>1&&console.warn("selector ".concat(e," return more then one element")),0===r.length)throw new Error("selector ".concat(e," return nothing"));return r.pop()}if(e instanceof HTMLElement)return e;throw new Error("Unknown selector element")}function cloneTemplate(e){var t=ensureElement(e).content.firstElementChild;return function(){return t.cloneNode(!0)}}function cardCatalogView_typeof(e){return cardCatalogView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cardCatalogView_typeof(e)}function cardCatalogView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cardCatalogView_toPrimitive(e,t){if("object"!==cardCatalogView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cardCatalogView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cardCatalogView_typeof(i)?i:String(i)),o)}var n,i}var v=function(){function CardCatalogView(e,t){!function cardCatalogView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CardCatalogView),this.emitter=e,this.mapper=t,this.card=CardCatalogView.clone(),this.category=this.card.querySelector(".card__category"),this.title=this.card.querySelector(".card__title"),this.image=this.card.querySelector(".card__image"),this.price=this.card.querySelector(".card__price")}return function cardCatalogView_createClass(e,t,r){return t&&cardCatalogView_defineProperties(e.prototype,t),r&&cardCatalogView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CardCatalogView,[{key:"render",value:function render(e){var t=this;this.category.textContent=e.category,this.category.classList.add(this.mapper.getCategory(e)),this.title.textContent=e.title,this.image.src=this.mapper.getUrl(e),this.image.alt=e.title,this.price.textContent=this.mapper.getPrice(e),this.card.addEventListener("click",(function(){return t.onOpenCard(e)}))}},{key:"onOpenCard",value:function onOpenCard(e){this.emitter.emit(i,e)}}]),CardCatalogView}();function galleryView_typeof(e){return galleryView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},galleryView_typeof(e)}function galleryView_toConsumableArray(e){return function galleryView_arrayWithoutHoles(e){if(Array.isArray(e))return galleryView_arrayLikeToArray(e)}(e)||function galleryView_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function galleryView_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return galleryView_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return galleryView_arrayLikeToArray(e,t)}(e)||function galleryView_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function galleryView_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function galleryView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function galleryView_toPrimitive(e,t){if("object"!==galleryView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==galleryView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===galleryView_typeof(i)?i:String(i)),o)}var n,i}v.clone=cloneTemplate("#card-catalog");var w=function(){function GalleryView(e,t){!function galleryView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GalleryView),this.emitter=e,this.mapper=t,this.gallery=document.querySelector(".gallery")}return function galleryView_createClass(e,t,r){return t&&galleryView_defineProperties(e.prototype,t),r&&galleryView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(GalleryView,[{key:"render",value:function render(e){var t,r=this,o=this.emitter,n=e.map((function(e){var t=new v(o,r.mapper);return t.render(e),t.card}));(t=this.gallery).replaceChildren.apply(t,galleryView_toConsumableArray(n))}}]),GalleryView}();function modalView_typeof(e){return modalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},modalView_typeof(e)}function modalView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function modalView_toPrimitive(e,t){if("object"!==modalView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==modalView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===modalView_typeof(i)?i:String(i)),o)}var n,i}var _,g=function(){function ModalView(){var e=this;!function modalView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ModalView),this.modal=document.querySelector("#modal-container"),this.container=this.modal.querySelector(".modal__container"),this.close=this.modal.querySelector(".modal__close"),this.content=this.modal.querySelector(".modal__content"),this.modal.addEventListener("click",(function(t){return e.hide()})),this.container.addEventListener("click",(function(e){return e.stopPropagation()})),this.close.addEventListener("click",(function(t){return e.hide()}))}return function modalView_createClass(e,t,r){return t&&modalView_defineProperties(e.prototype,t),r&&modalView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ModalView,[{key:"render",value:function render(e){this.content.replaceChildren(e)}},{key:"show",value:function show(){this.modal.classList.add("modal_active")}},{key:"hide",value:function hide(){this.modal.classList.remove("modal_active")}}]),ModalView}();function cardModalView_typeof(e){return cardModalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cardModalView_typeof(e)}function cardModalView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cardModalView_toPrimitive(e,t){if("object"!==cardModalView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cardModalView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cardModalView_typeof(i)?i:String(i)),o)}var n,i}!function(e){e.Buy="Купить",e.Cart="В корзину"}(_||(_={}));var S=function(){function CardModalView(e,t,r,o){!function cardModalView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CardModalView),this.emitter=e,this.modal=t,this.cart=r,this.mapper=o,this.card=CardModalView.clone(),this.image=this.card.querySelector(".card__image"),this.category=this.card.querySelector(".card__category"),this.title=this.card.querySelector(".card__title"),this.description=this.card.querySelector(".card__text"),this.price=this.card.querySelector(".card__price"),this.button=this.card.querySelector(".card__row>.button")}return function cardModalView_createClass(e,t,r){return t&&cardModalView_defineProperties(e.prototype,t),r&&cardModalView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CardModalView,[{key:"render",value:function render(e){var t=this;this.category.textContent=e.category,this.category.classList.add(this.mapper.getCategory(e)),this.title.textContent=e.title,this.description.textContent=e.description,this.image.src=this.mapper.getUrl(e),this.image.alt=e.title,this.price.textContent=this.mapper.getPrice(e),this.button.textContent=this.buttonStatus=this.cart.contains(e)?_.Cart:_.Buy,this.button.disabled=null==e.price,this.button.addEventListener("click",(function(){return t.onClick(e)})),this.modal.render(this.card)}},{key:"onClick",value:function onClick(e){if(this.buttonStatus===_.Buy)return this.emitter.emit(a,e),void(this.button.textContent=this.buttonStatus=_.Cart);this.emitter.emit(l)}}]),CardModalView}();function cardCartView_typeof(e){return cardCartView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cardCartView_typeof(e)}function cardCartView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cardCartView_toPrimitive(e,t){if("object"!==cardCartView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cardCartView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cardCartView_typeof(i)?i:String(i)),o)}var n,i}S.clone=cloneTemplate("#card-preview");var C=function(){function CardCartView(e,t){!function cardCartView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CardCartView),this.emitter=e,this.mapper=t,this.card=CardCartView.clone(),this.index=this.card.querySelector(".basket__item-index"),this.title=this.card.querySelector(".card__title"),this.price=this.card.querySelector(".card__price"),this.button=this.card.querySelector(".basket__item-delete")}return function cardCartView_createClass(e,t,r){return t&&cardCartView_defineProperties(e.prototype,t),r&&cardCartView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CardCartView,[{key:"render",value:function render(e,t){var r=this;this.index.textContent=t.toString(),this.title.textContent=e.title,this.price.textContent=this.mapper.getPrice(e),this.button.addEventListener("click",(function(){return r.onDelete(e)}))}},{key:"onDelete",value:function onDelete(e){this.emitter.emit(c,e),this.emitter.emit(l)}}]),CardCartView}();function cartModalView_typeof(e){return cartModalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cartModalView_typeof(e)}function cartModalView_toConsumableArray(e){return function cartModalView_arrayWithoutHoles(e){if(Array.isArray(e))return cartModalView_arrayLikeToArray(e)}(e)||function cartModalView_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function cartModalView_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return cartModalView_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cartModalView_arrayLikeToArray(e,t)}(e)||function cartModalView_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cartModalView_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function cartModalView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cartModalView_toPrimitive(e,t){if("object"!==cartModalView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cartModalView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cartModalView_typeof(i)?i:String(i)),o)}var n,i}C.clone=cloneTemplate("#card-basket");var V=function(){function CartModalView(e,t,r,o){!function cartModalView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CartModalView),this.emitter=e,this.modal=t,this.cart=r,this.mapper=o,this.element=CartModalView.clone(),this.list=this.element.querySelector(".basket__list"),this.price=this.element.querySelector(".basket__price"),this.button=this.element.querySelector(".basket__button")}return function cartModalView_createClass(e,t,r){return t&&cartModalView_defineProperties(e.prototype,t),r&&cartModalView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CartModalView,[{key:"render",value:function render(){var e,t=this,r=this.emitter,o=this.cart.getProducts(),n=o.map((function(e,o){var n=new C(r,t.mapper);return n.render(e,o+1),n.card}));(e=this.list).replaceChildren.apply(e,cartModalView_toConsumableArray(n)),this.price.textContent=this.mapper.getPrice(this.cart.getPrice()),this.button.disabled=0==o.length,this.button.addEventListener("click",(function(){return t.onOpenOrder()})),this.modal.render(this.element)}},{key:"onOpenOrder",value:function onOpenOrder(){this.emitter.emit(u)}}]),CartModalView}();function orderModalView_typeof(e){return orderModalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},orderModalView_typeof(e)}function orderModalView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function orderModalView_toPrimitive(e,t){if("object"!==orderModalView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==orderModalView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===orderModalView_typeof(i)?i:String(i)),o)}var n,i}V.clone=cloneTemplate("#basket");var P=function(){function OrderModalView(e,t,r){!function orderModalView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,OrderModalView),this.emitter=e,this.modal=t,this.order=r,this.form=OrderModalView.clone(),this.buttonCard=this.form.querySelector(".button__card"),this.buttonCash=this.form.querySelector(".button__cash"),this.address=this.form.querySelector(".form__input"),this.button=this.form.querySelector(".order__button")}return function orderModalView_createClass(e,t,r){return t&&orderModalView_defineProperties(e.prototype,t),r&&orderModalView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(OrderModalView,[{key:"render",value:function render(){var e=this;this.address.value=this.order.address,this.order.payType==p.Online&&this.buttonCard.classList.add("button_alt-active"),this.order.payType==p.Offline&&this.buttonCash.classList.add("button_alt-active"),this.updateButtonStatus(),this.address.addEventListener("input",(function(){return e.onInputAddress()})),this.buttonCard.addEventListener("click",(function(){return e.onClickCard()})),this.buttonCash.addEventListener("click",(function(){return e.onClickCash()})),this.form.addEventListener("submit",(function(t){return e.onSubmit(t)})),this.modal.render(this.form)}},{key:"updateButtonStatus",value:function updateButtonStatus(){this.button.disabled=null==this.order.payType||""==this.order.address}},{key:"onInputAddress",value:function onInputAddress(){this.order.address=this.address.value,this.updateButtonStatus()}},{key:"onClickCard",value:function onClickCard(){this.order.payType=p.Online,this.buttonCard.classList.add("button_alt-active"),this.buttonCash.classList.remove("button_alt-active"),this.updateButtonStatus()}},{key:"onClickCash",value:function onClickCash(){this.order.payType=p.Offline,this.buttonCard.classList.remove("button_alt-active"),this.buttonCash.classList.add("button_alt-active"),this.updateButtonStatus()}},{key:"onSubmit",value:function onSubmit(e){e.preventDefault(),this.emitter.emit(s)}}]),OrderModalView}();function contactsModalView_typeof(e){return contactsModalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},contactsModalView_typeof(e)}function contactsModalView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function contactsModalView_toPrimitive(e,t){if("object"!==contactsModalView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==contactsModalView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===contactsModalView_typeof(i)?i:String(i)),o)}var n,i}P.clone=cloneTemplate("#order");var M=function(){function ContactsModalView(e,t,r){!function contactsModalView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ContactsModalView),this.emitter=e,this.modal=t,this.order=r,this.form=ContactsModalView.clone(),this.email=this.form.querySelector(".input__email"),this.phone=this.form.querySelector(".input__phone"),this.button=this.form.querySelector(".button")}return function contactsModalView_createClass(e,t,r){return t&&contactsModalView_defineProperties(e.prototype,t),r&&contactsModalView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ContactsModalView,[{key:"render",value:function render(){var e=this;this.email.value=this.order.email,this.phone.value=this.order.phone,this.updateButtonStatus(),this.email.addEventListener("input",(function(){return e.onInputEmail()})),this.phone.addEventListener("input",(function(){return e.onInputPhone()})),this.form.addEventListener("submit",(function(t){return e.onSubmit(t)})),this.modal.render(this.form)}},{key:"updateButtonStatus",value:function updateButtonStatus(){this.button.disabled=""==this.order.email||""==this.order.phone}},{key:"onInputEmail",value:function onInputEmail(){this.order.email=this.email.value,this.updateButtonStatus()}},{key:"onInputPhone",value:function onInputPhone(){this.order.phone=this.phone.value,this.updateButtonStatus()}},{key:"onSubmit",value:function onSubmit(e){e.preventDefault(),this.emitter.emit(f)}}]),ContactsModalView}();function successModalView_typeof(e){return successModalView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},successModalView_typeof(e)}function successModalView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function successModalView_toPrimitive(e,t){if("object"!==successModalView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==successModalView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===successModalView_typeof(i)?i:String(i)),o)}var n,i}M.clone=cloneTemplate("#contacts");var k=function(){function SuccessModalView(e){!function successModalView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SuccessModalView),this.modal=e,this.element=SuccessModalView.clone(),this.description=this.element.querySelector(".order-success__description"),this.button=this.element.querySelector(".order-success__close")}return function successModalView_createClass(e,t,r){return t&&successModalView_defineProperties(e.prototype,t),r&&successModalView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(SuccessModalView,[{key:"render",value:function render(e){var t=this;this.description.textContent="Списано ".concat(e.total," синапсов"),this.button.addEventListener("click",(function(){return t.onClick()})),this.modal.render(this.element)}},{key:"onClick",value:function onClick(){this.modal.hide()}}]),SuccessModalView}();function ProductMapper_typeof(e){return ProductMapper_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ProductMapper_typeof(e)}function ProductMapper_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function ProductMapper_toPrimitive(e,t){if("object"!==ProductMapper_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==ProductMapper_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===ProductMapper_typeof(i)?i:String(i)),o)}var n,i}k.clone=cloneTemplate("#success");var j=function(){function ProductMapper(){!function ProductMapper_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ProductMapper)}return function ProductMapper_createClass(e,t,r){return t&&ProductMapper_defineProperties(e.prototype,t),r&&ProductMapper_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ProductMapper,[{key:"getCategory",value:function getCategory(e){switch(e.category){case"софт-скил":return"card__category_soft";case"хард-скил":return"card__category_hard";case"другое":return"card__category_other";case"дополнительное":return"card__category_additional";case"кнопка":return"card__category_button"}}},{key:"getUrl",value:function getUrl(e){return o+e.image}},{key:"getPrice",value:function getPrice(e){var t="number"==typeof e?e:e.price;return null!=t?"".concat(t," синапсов"):"Бесценно"}}]),ProductMapper}(),E=new e,T=new b(new t(r)),O=new m,A=new h,L=new j,q=document.querySelector(".header__basket"),U=document.querySelector(".header__basket-counter");q.addEventListener("click",(function(){return E.emit(l)}));var I=new w(E,L),x=new g;E.on(y,(function(){return U.textContent="".concat(O.getProducts().length)})),E.on(n,(function(e){return I.render(e)})),E.on(i,(function(e){new S(E,x,O,L).render(e),x.show()})),E.on(l,(function(){new V(E,x,O,L).render(),x.show()})),E.on(u,(function(){new P(E,x,A).render(),x.show()})),E.on(s,(function(){new M(E,x,A).render(),x.show()})),E.on(d,(function(e){new k(x).render(e),x.show()})),E.on(a,(function(e){O.add(e),E.emit(y)})),E.on(c,(function(e){O.delete(e),E.emit(y)})),E.on(f,(function(){return T.order({payment:A.payType,email:A.email,phone:A.phone,address:A.address,total:O.getPrice(),items:O.getProducts().map((function(e){return e.id}))}).then((function(e){O.clear(),E.emit(d,e)}))})),T.loadProducts().then((function(e){return E.emit(n,e.items)}))})();
//# sourceMappingURL=main.js.map